{% extends "base.html" %}

{% block title %}
    {{ blogpost.title_tag }}
{% endblock %}

{% block content %}

<h1>{{ blogpost.title }}</h1>
<strong>
    By: {{ blogpost.author.first_name }} {{ blogpost.author.last_name }} On: {{ blogpost.created_at | date:"F d, Y - P" }}
</strong>
{% if user.is_authenticated %}
    {% if user.id == blogpost.author.id %}
        |
        <a href="{% url 'edit-post' blogpost.pk %}">
            <strong>
                [Edit Post]
            </strong>
        </a>
        |
        <a href="{% url 'delete-post' blogpost.pk %}">
            <strong>
                [Delete Post]
            </strong>
        </a>
        |
    {% endif %}
{% endif %}
<br/>
<small>@{{ blogpost.author }}</small><br><hr>
{% if blogpost.header_image %}
    <div>
        <img src="{{ blogpost.header_image.url }}" alt="Blog Media" style="max-width:100%; height:auto;"> 
    </div>
    <br>
{% endif %}
<p>{{ blogpost.content | safe | linebreaks }}</p>

<br><hr><br>
{% if user.is_authenticated %}
    <form action="{% url 'like-post' blogpost.pk %}" method="POST" style="display:inline;">
        {% csrf_token %}
        <button type="submit" name="post_id" value="{{ blogpost.id }}" class="btn btn-sm 
            {% if has_liked %}btn-success{% else %}btn-outline-success{% endif %}">
            {% if has_liked %}
                Liked
            {% else %}
                Like üëç
            {% endif %}
        </button>
        {% if blogpost.likes.count > 0 %}
             {{ blogpost.likes.count }}
        {% endif %}
    </form>
    <form action="{% url 'dislike-post' blogpost.pk %}" method="POST" style="display:inline; margin-left: 10px;">
        {% csrf_token %}
        <button type="submit" name="post_id" value="{{ blogpost.id }}" class="btn btn-sm 
            {% if has_disliked %}btn-danger{% else %}btn-outline-danger{% endif %}">
            {% if has_disliked %}
                Disliked
            {% else %}
                Dislike üëé
            {% endif %}
        </button>
        {% if blogpost.dislikes.count > 0 %}
            {{ blogpost.dislikes.count }}
        {% endif %}
    </form>
{% else %}
    <p>
        <a href="{% url 'login' %}">Log in</a> to like or dislike this post.
    </p>
{% endif %}

<br><hr><br>

<a href="{% url 'home' %}" class="btn btn-secondary">Back to Home</a>
{% endblock %}
